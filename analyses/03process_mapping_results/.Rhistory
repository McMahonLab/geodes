gff <- read.table("C:/Users/Alex/Desktop/geodes/analyses/02mapping/mapping_database.gff.txt", fill = NA)
gff <- read.table("C:/Users/Alex/Desktop/geodes/analyses/02mapping/mapping_database.gff", fill = NA)
gff <- read.csv("C:/Users/Alex/Desktop/geodes/analyses/02mapping/mapping_database.csv", header = T, fill = NA)
head(gff)
metaT_table <- read.table("C:/Users/Alex/Desktop/geodes/analyses/03process_mapping_results/GEODES_genes_2017-02-22.txt", row.names=1, header = T)
metaT_table <- metaT_table[which(rowSums(metaT_table) > 0), ]
contig_file <- read.table("C:/Users/Alex/Desktop/geodes/analyses/03process_mapping_results/contig_metadata.txt")
contigs <- data.frame(substr(contig_file$V1, start = 1, stop = 10), substr(contig_file$V1, start = 19, stop = 100), stringsAsFactors = F)
contigs[41209, ] <- c("standard", "pFN18A_DNA_transcript")
colnames(contigs) <- c("Genome", "Contig")
rowkey <- data.frame(rownames(metaT_table), stringsAsFactors = F)
colnames(rowkey) <- c("Hits")
x <- match(rowkey$Hits, locus_tag)
x <- match(rowkey$Hits, gff$Locus_tag)
head(x)
tail(x)
tail(rowkey$Hits)
length(is.na(x) == T)
head(gff[which(is.na(x) == T), ])
is.na(x)
length(is.na(x) == T)
length(which(is.na(x) == T))
rowkey$Contig <- gff$V1[x]
head(rowkey)
gff$V1[x]
rowkey$Contig <- gff$Contig[x]
head(rowkey)
rowkey$Product <- gff$Product[x]
head(rowkey)
head(contigs)
y <- match(rowkey$Contig, contigs$Contig)
length(which(is.na(y) == T))
rowkey$Genome <- contigs$Genome[y]
head(rowkey)
genome_data <- read.csv("C:/Users/Alex/Desktop/geodes/analyses/03process_mapping_results/README.csv", header = T)
head(genome_data)
phylogeny <- paste(genome_data[, 2:6], collapse = ";")
head(phylogeny)
genome_data <- read.csv("C:/Users/Alex/Desktop/geodes/analyses/03process_mapping_results/README.csv", header = T, colClasses = c("character"))
phylogeny <- paste(genome_data[, 2:6], collapse = ";")
head(phylogeny)
head(genome_data)
head(genome_data[, 2:6])
phylogeny <- c()
for(i in 1:dim(genome_data)[1]{
phylogeny[i]<- paste(genome_data[i, 2:6], collapse = ";")
}
phylogeny <- c()
for(i in 1:dim(genome_data)[1]){
phylogeny[i]<- paste(genome_data[i, 2:6], collapse = ";")
}
head(phylogeny)
z <- match(rowkey$Genome, genome_data$IMG.OID)
rowkey$Phylogeny <- phylogeny[z]
head(rowkey)
