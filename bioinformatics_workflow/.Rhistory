mag_data <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Supplemental/MAG_information.csv", header = T)
mag_data$Taxonomy <- as.character(mag_data$Taxonomy)
mag_data <- read.csv("C:/Users/amlin/Desktop/MAGstravaganza/Supplemental/MAG_information.csv", header = T)
mag_data$Taxonomy <- as.character(mag_data$Taxonomy)
mag_data$Lake <- as.character(mag_data$Lake)
gh_names <- c()
gh_counts <- c()
magIDs <- c()
lakekey <- c()
taxonomy <- c()
for(i in 1:dim(mag_data)[1]){
datafile <- read.table(paste("C:/Users/amlin/Desktop/MAGstravaganza/hydrolases/", mag_data$IMG_OID[i], ".txt", sep = ""))
hits <- sub(".hmm", "", datafile$V2)
types <- substr(hits, start = 1, stop = 2)
gh_hits <- hits[which(types == "GH")]
gh_table <- table(gh_hits)
ghs <- names(gh_table)
genome <- rep(mag_data$IMG_OID[i], length(ghs))
lake <- rep(mag_data$Lake[i], length(ghs))
tax <- rep(mag_data$Taxonomy[i], length(ghs))
gh_names <- append(gh_names, ghs, length(gh_names))
gh_counts <- append(gh_counts, gh_table, length(gh_counts))
magIDs <- append(magIDs, genome, length(magIDs))
lakekey <- append(lakekey, lake, length(lakekey))
taxonomy <- append(taxonomy, tax, length(taxonomy))
}
gh_types <- data.frame(gh_names, gh_counts, magIDs, lakekey, taxonomy)
colnames(gh_types) <- c("GH", "Counts", "OID", "Lake", "Taxonomy")
#What are the 10 most aboundant GHs by lake?
gh_lake <- aggregate(Counts ~ GH + Lake, data = gh_types, sum)
ME <- gh_lake[which(gh_lake$Lake == "Mendota"),]
ME <- ME[order(ME$Counts, decreasing = T), ]
ME[1:10,]
TE <- gh_lake[which(gh_lake$Lake == "Trout Bog Epilimnion"),]
TE <- TE[order(TE$Counts, decreasing = T), ]
TE[1:10,]
TH <- gh_lake[which(gh_lake$Lake == "Trout Bog Hypolimnion"),]
TH <- TH[order(TH$Counts, decreasing = T), ]
TH[1:10,]
dim(ME)
for(i in 1:dim(ME)[1]){
inTE <- which(TE$GH == ME$GH[i])
inTH <- which(TH$GH == ME$GH[i])
if(length(inTE) == 0 && length(inTH) == 0){
print(ME[i])
}
}
for(i in 1:dim(ME)[1]){
inTE <- which(TE$GH == ME$GH[i])
inTH <- which(TH$GH == ME$GH[i])
if(length(inTE) == 0 && length(inTH) == 0){
print(ME[i,])
}
}
for(i in 1:dim(TE)[1]){
inME <- which(ME$GH == ME$GH[i])
inTH <- which(TH$GH == ME$GH[i])
if(length(inME) == 0 && length(inTH) == 0){
print(TE[i,])
}
}
for(i in 1:dim(TE)[1]){
inME <- which(ME$GH == TE$GH[i])
inTH <- which(TH$GH == TE$GH[i])
if(length(inME) == 0 && length(inTH) == 0){
print(TE[i,])
}
}
for(i in 1:dim(TH)[1]){
inTE <- which(TE$GH == TH$GH[i])
inME <- which(ME$GH == TH$GH[i])
if(length(inTE) == 0 && length(inME) == 0){
print(TH[i,])
}
}
head(mag_data)
library(ggplot2)
libray(cowplot)
library(cowplot)
ggplot(mag_data, aes(x = Lake, y = Amino_Acid_Bias)) + geom_boxplot()
ggplot(mag_data, aes(x = Lake, y = GC)) + geom_boxplot()
ggplot(mag_data, aes(x = Lake, y = GC_Content)) + geom_boxplot()
ggplot(mag_data, aes(x = Lake, y = Amino_Acid_Bias)) + geom_violin()
wilcox.text(x = mag_data$Amino_Acid_Bias[which(mag_data$Lake == "Mendota")], y = mag_data$Amino_Acid_Bias[which(mag_data$Lake =! "Mendota")], paired = F)
wilcox.text(x = mag_data$Amino_Acid_Bias[which(mag_data$Lake == "Mendota"),], y = mag_data$Amino_Acid_Bias[which(mag_data$Lake =! "Mendota"),], paired = F)
wilcox.text(x = mag_data$Amino_Acid_Bias[which(mag_data$Lake == "Mendota"),], y = mag_data$Amino_Acid_Bias[which(mag_data$Lake != "Mendota"),], paired = F)
wilcox.test(x = mag_data$Amino_Acid_Bias[which(mag_data$Lake == "Mendota"),], y = mag_data$Amino_Acid_Bias[which(mag_data$Lake != "Mendota"),], paired = F)
wilcox.test(x = mag_data$Amino_Acid_Bias[which(mag_data$Lake == "Mendota")], y = mag_data$Amino_Acid_Bias[which(mag_data$Lake != "Mendota")], paired = F)
wilcox.test(x = mag_data$GC_Content[which(mag_data$Lake == "Mendota")], y = mag_data$GC_Content[which(mag_data$Lake != "Mendota")], paired = F)
head mag_data
head(mag_data)
mag_data$Est_Genome_Size <- mag_data$Genome_Size/mag_data$Est_Completeness
wilcox.test(x = mag_data$Est_Genome_Size[which(mag_data$Lake == "Mendota")], y = mag_data$Est_Genome_Size[which(mag_data$Lake != "Mendota")], paired = F)
