metaG_reads <- sweep(metaG_reads, 2, colSums(metaG_reads), "/")
head(metaG_reads)
head(metaG_key)
colnames(metaG_key) <- c("Gene", "Genome", "Taxonomy", "Product")
metaG_key$Taxonomy <- gsub("Bacteria;", "", spark_key$Taxonomy)
metaG_key$Taxonomy <- gsub("Bacteria;", "", metaG_key$Taxonomy)
metaG_key$Taxonomy <- gsub("Eukaryota;", "", metaG_key$Taxonomy)
metaG_key$Phylum <- sapply(strsplit(as.character(spark_key$Taxonomy),";"), `[`, 1)
metaG_key$Phylum <- sapply(strsplit(as.character(metaG_key$Taxonomy),";"), `[`, 1)
head(metaG_key)
tail(metaG_key)
metaG_reads$Genes <- rownames(metaG_reads)
head(metaG_reads)
spark_metaG <- metaG_reads[,c(1,2, 11)]
trout_metaG <- metaG_reads[,c(3,4, 11)]
mendota_metaG <- metaG_reads[,c(5,6, 11)]
spark2_metaG <- metaG_reads[,c(7,8,9,10, 11)]
spark_metaG <- melt(spark_metaG)
library(reshape2)
spark_metaG <- melt(spark_metaG)
head(spakr_metaG)
head(spark_metaG)
trout_metaG <- melt(trout_metaG)
mendota_metaG <- melt(mendota_metaG)
spark2_metaG <- melt(spark2_metaG)
spark_metaG$Taxonomy <- metaG_key$Taxonomy[match(spark_metaG$Genes, metaG_key$Gene)]
head(spark_metaG)
spark_metaG <- metaG_reads[,c(1,2, 11)]
spark_metaG <- melt(spark_metaG)
spark_metaG$Phylum <- metaG_key$Phylum[match(spark_metaG$Genes, metaG_key$Gene)]
head(spark_metaG)
unique(spark_metaG$Phylum)
spark_metaG$Phylum <- metaG_key$Phylum[match(spark_metaG$Genes, metaG_key$Gene)]
spark_metaG$Phylum <- gsub("Cryptophyta,Cryptophyceae,Pyrenomonadales,Geminigeraceae,Guillardia,theta", "Cryptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Haptophyta,Prymnesiophyceae,Isochrysidales,Noelaerhabdaceae,Emiliania,huxleyi", "Haptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Coscinodiscophyceae,Thalassiosirales,Thalassiosiraceae,Thalassiosira,pseudonana", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Pelagophyceae,Pelagomonadales,Pelagomonadaceae,Aureococcus,anophagefferens", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Ochrophyta,Eustigmataphyceae,Eustigmataceae,Nannochloropsis,gaditana", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Bacillariophyceae,Naviculales,Phaeodactylaceae,Phaeodactylum,tricornutum", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("NO CLASSIFICATION MH", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("NO CLASSIFICATION LP", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("None", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified Perkinsida", "Perkinsozoa", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified Isochyrsidales", "Haptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified Oligohymenophorea", "Ciliophora", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified Pelagophyceae", "Ochrophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Taxonomy[which(is.na(spark_metaG$Phylum))] <- "Unclassified"
spark_metaG$Phylum[which(is.na(spark_metaG$Phylum))] <- "Unclassified"
spark_phyla <- aggregate(value ~ Phylum, data = spark_metaG, mean)
spark_phyla
spark_metaG$Phylum <- metaG_key$Phylum[match(spark_metaG$Genes, metaG_key$Gene)]
spark_metaG$Phylum <- gsub("Cryptophyta,Cryptophyceae,Pyrenomonadales,Geminigeraceae,Guillardia,theta", "Cryptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Haptophyta,Prymnesiophyceae,Isochrysidales,Noelaerhabdaceae,Emiliania,huxleyi", "Haptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Coscinodiscophyceae,Thalassiosirales,Thalassiosiraceae,Thalassiosira,pseudonana", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Pelagophyceae,Pelagomonadales,Pelagomonadaceae,Aureococcus,anophagefferens", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Ochrophyta,Eustigmataphyceae,Eustigmataceae,Nannochloropsis,gaditana", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Bacillariophyceae,Naviculales,Phaeodactylaceae,Phaeodactylum,tricornutum", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("NO CLASSIFICATION MH", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("NO CLASSIFICATION LP", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("None", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified Perkinsida", "Perkinsozoa", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified Isochyrsidales", "Haptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified Isochyrsidales", "Haptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified Oligohymenophorea", "Ciliophora", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified Pelagophyceae", "Ochrophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Unclassified ", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum[which(is.na(spark_metaG$Phylum))] <- "Unclassified"
spark_phyla <- aggregate(value ~ Phylum, data = spark_metaG, mean)
spark_phyla
spark_metaG$Phylum <- metaG_key$Phylum[match(spark_metaG$Genes, metaG_key$Gene)]
spark_metaG[,which(spark_metaG$Phylum == "unclassified Isochrysidales")]
spark_metaG[,which(spark_metaG$Phylum == "unclassified unclassified Isochrysidales")]
spark_metaG$Phylum <- metaG_key$Phylum[match(spark_metaG$Genes, metaG_key$Gene)]
spark_metaG$Phylum <- gsub("Cryptophyta,Cryptophyceae,Pyrenomonadales,Geminigeraceae,Guillardia,theta", "Cryptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Haptophyta,Prymnesiophyceae,Isochrysidales,Noelaerhabdaceae,Emiliania,huxleyi", "Haptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Coscinodiscophyceae,Thalassiosirales,Thalassiosiraceae,Thalassiosira,pseudonana", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Pelagophyceae,Pelagomonadales,Pelagomonadaceae,Aureococcus,anophagefferens", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Ochrophyta,Eustigmataphyceae,Eustigmataceae,Nannochloropsis,gaditana", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Bacillariophyceae,Naviculales,Phaeodactylaceae,Phaeodactylum,tricornutum", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("NO CLASSIFICATION MH", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("NO CLASSIFICATION LP", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("None", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified Perkinsida", "Perkinsozoa", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified Oligohymenophorea", "Ciliophora", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified Pelagophyceae", "Ochrophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Unclassified ", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum[which(is.na(spark_metaG$Phylum))] <- "Unclassified"
spark_phyla <- aggregate(value ~ Phylum, data = spark_metaG, mean)
spark_phyla
spark_metaG$Phylum <- metaG_key$Phylum[match(spark_metaG$Genes, metaG_key$Gene)]
spark_metaG$Phylum <- gsub("Cryptophyta,Cryptophyceae,Pyrenomonadales,Geminigeraceae,Guillardia,theta", "Cryptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Haptophyta,Prymnesiophyceae,Isochrysidales,Noelaerhabdaceae,Emiliania,huxleyi", "Haptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Coscinodiscophyceae,Thalassiosirales,Thalassiosiraceae,Thalassiosira,pseudonana", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Pelagophyceae,Pelagomonadales,Pelagomonadaceae,Aureococcus,anophagefferens", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Ochrophyta,Eustigmataphyceae,Eustigmataceae,Nannochloropsis,gaditana", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Heterokonta,Bacillariophyceae,Naviculales,Phaeodactylaceae,Phaeodactylum,tricornutum", "Heterokonta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("NO CLASSIFICATION MH", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("NO CLASSIFICATION LP", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("None", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified Perkinsida", "Perkinsozoa", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified Isochyrsidales", "Haptophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified Oligohymenophorea", "Ciliophora", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified Pelagophyceae", "Ochrophyta", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("unclassified", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum <- gsub("Unclassified ", "Unclassified", spark_metaG$Phylum)
spark_metaG$Phylum[which(is.na(spark_metaG$Phylum))] <- "Unclassified"
spark_phyla <- aggregate(value ~ Phylum, data = spark_metaG, mean)
spark_phyla
spark_metaG$Phylum <- gsub("UnclassifiedIsochyrsidales", "Haptophyta", spark_metaG$Phylum)
spark_phyla <- aggregate(value ~ Phylum, data = spark_metaG, mean)
spark_phyla
spark_metaG$Phylum <- gsub("unclassified Isochrysidales", "Haptophyta", spark_metaG$Phylum)
spark_phyla <- aggregate(value ~ Phylum, data = spark_metaG, mean)
spark_phyla
spark_metaG$Phylum <- gsub("UnclassifiedIsochrysidales", "Haptophyta", spark_metaG$Phylum)
spark_phyla <- aggregate(value ~ Phylum, data = spark_metaG, mean)
spark_phyla
spark_phyla$Type <- c("Unclassified", "Bacteria", "Bacteria", "Bacteria", "Animals", "Fungi", "Algae", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Algae", "Fungi", "Protists", "Algae", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Algae", "Algae", "Bacteria", "Bacteria",  "Bacteria", "Bacteria", "Algae", "Protists", "Algae", "Bacteria", "Animals", "Bacteria", "Bacteria", "Algae", "Bacteria", "Unclassified", "Bacteria", "Viruses")
spark_phyla$Type <- c("Unclassified", "Bacteria", "Bacteria", "Bacteria", "Animals", "Fungi", "Algae", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Algae", "Fungi", "Protists", "Algae", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Algae", "Algae", "Bacteria", "Bacteria",  "Bacteria", "Bacteria", "Algae", "Protists", "Algae", "Bacteria", "Animals", "Bacteria", "Bacteria", "Algae", "Bacteria", "Unclassified", "Bacteria", "Viruses")
p <- ggplot(spark_phyla, aes(x = Taxonomy, y = Sums, fill = Type)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, vjust = 0, hjust = 1)) + scale_fill_brewer(palette = "Set2") + labs(x = "", y = "Read Counts", title = "Sparkling Lake Metagenomes")
library(ggplot2)
ggplot(spark_phyla, aes(x = Taxonomy, y = Sums, fill = Type)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, vjust = 0, hjust = 1)) + scale_fill_brewer(palette = "Set2") + labs(x = "", y = "Read Counts", title = "Sparkling Lake Metagenomes")
p <- ggplot(spark_phyla, aes(x = Phylum, y = value, fill = Type)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, vjust = 0, hjust = 1)) + scale_fill_brewer(palette = "Set2") + labs(x = "", y = "Read Counts", title = "Sparkling Lake Metagenomes")
p
library(cowplot)
spark_phyla$Phylum <- factor(spark_phyla$Phylum, levels = spark_phyla$Phylum[order(spark_phyla$value, decreasing = T)])
p <- ggplot(spark_phyla, aes(x = Phylum, y = value, fill = Type)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, vjust = 0, hjust = 1)) + scale_fill_brewer(palette = "Set2") + labs(x = "", y = "Read Counts", title = "Sparkling Lake Metagenomes")
p
save_plot("C:/Users/Alex/Desktop/geodes/Plots/spark_metagenome_by_phyla.pdf", p, base_height = 5, base_aspect_ratio = 1.5)
save_plot("C:/Users/Alex/Desktop/geodes/Plots/spark_metagenome_by_phyla.pdf", p, base_height = 5, base_aspect_ratio = 1.6)
Trout_metaG$Phylum <- metaG_key$Phylum[match(Trout_metaG$Genes, metaG_key$Gene)]
Trout_metaG$Phylum <- gsub("Cryptophyta,Cryptophyceae,Pyrenomonadales,Geminigeraceae,Guillardia,theta", "Cryptophyta", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("Haptophyta,Prymnesiophyceae,Isochrysidales,Noelaerhabdaceae,Emiliania,huxleyi", "Haptophyta", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("Heterokonta,Coscinodiscophyceae,Thalassiosirales,Thalassiosiraceae,Thalassiosira,pseudonana", "Heterokonta", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("Heterokonta,Pelagophyceae,Pelagomonadales,Pelagomonadaceae,Aureococcus,anophagefferens", "Heterokonta", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("Heterokonta,Ochrophyta,Eustigmataphyceae,Eustigmataceae,Nannochloropsis,gaditana", "Heterokonta", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("Heterokonta,Bacillariophyceae,Naviculales,Phaeodactylaceae,Phaeodactylum,tricornutum", "Heterokonta", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified unclassified", "Unclassified", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified", "Unclassified", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("unclassified unclassified unclassified", "Unclassified", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("NO CLASSIFICATION MH", "Unclassified", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("NO CLASSIFICATION LP", "Unclassified", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("None", "Unclassified", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("unclassified unclassified Perkinsida", "Perkinsozoa", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("unclassified unclassified", "Unclassified", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("unclassified Oligohymenophorea", "Ciliophora", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("unclassified Pelagophyceae", "Ochrophyta", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("unclassified", "Unclassified", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("Unclassified ", "Unclassified", Trout_metaG$Phylum)
Trout_metaG$Phylum <- gsub("UnclassifiedIsochrysidales", "Haptophyta", Trout_metaG$Phylum)
Trout_metaG$Phylum[which(is.na(Trout_metaG$Phylum))] <- "Unclassified"
Trout_phyla <- aggregate(value ~ Phylum, data = Trout_metaG, mean)
trout_metaG$Phylum <- metaG_key$Phylum[match(trout_metaG$Genes, metaG_key$Gene)]
trout_metaG$Phylum <- gsub("Cryptophyta,Cryptophyceae,Pyrenomonadales,Geminigeraceae,Guillardia,theta", "Cryptophyta", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("Haptophyta,Prymnesiophyceae,Isochrysidales,Noelaerhabdaceae,Emiliania,huxleyi", "Haptophyta", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("Heterokonta,Coscinodiscophyceae,Thalassiosirales,Thalassiosiraceae,Thalassiosira,pseudonana", "Heterokonta", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("Heterokonta,Pelagophyceae,Pelagomonadales,Pelagomonadaceae,Aureococcus,anophagefferens", "Heterokonta", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("Heterokonta,Ochrophyta,Eustigmataphyceae,Eustigmataceae,Nannochloropsis,gaditana", "Heterokonta", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("Heterokonta,Bacillariophyceae,Naviculales,Phaeodactylaceae,Phaeodactylum,tricornutum", "Heterokonta", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified unclassified", "Unclassified", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified", "Unclassified", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("unclassified unclassified unclassified", "Unclassified", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("NO CLASSIFICATION MH", "Unclassified", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("NO CLASSIFICATION LP", "Unclassified", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("None", "Unclassified", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("unclassified unclassified Perkinsida", "Perkinsozoa", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("unclassified unclassified", "Unclassified", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("unclassified Oligohymenophorea", "Ciliophora", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("unclassified Pelagophyceae", "Ochrophyta", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("unclassified", "Unclassified", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("Unclassified ", "Unclassified", trout_metaG$Phylum)
trout_metaG$Phylum <- gsub("UnclassifiedIsochrysidales", "Haptophyta", trout_metaG$Phylum)
trout_metaG$Phylum[which(is.na(trout_metaG$Phylum))] <- "Unclassified"
trout_phyla <- aggregate(value ~ Phylum, data = trout_metaG, mean)
trout_phyla
p <- ggplot(Trout_phyla, aes(x = Phylum, y = value, fill = Type)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, vjust = 0, hjust = 1)) + scale_fill_brewer(palette = "Set2") + labs(x = "", y = "Read Counts", title = "Trout Bog Metagenomes")
trout_phyla$Type <- c("Unclassified", "Bacteria", "Bacteria", "Bacteria", "Animals", "Fungi", "Algae", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Algae", "Fungi", "Protists", "Algae", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Algae", "Algae", "Bacteria", "Bacteria",  "Bacteria", "Bacteria", "Algae", "Protists", "Algae", "Bacteria", "Animals", "Bacteria", "Bacteria", "Algae", "Bacteria", "Unclassified", "Bacteria", "Viruses")
trout_phyla$Phylum <- factor(trout_phyla$Phylum, levels = trout_phyla$Phylum[order(trout_phyla$value, decreasing = T)])
p <- ggplot(trout_phyla, aes(x = Phylum, y = value, fill = Type)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, vjust = 0, hjust = 1)) + scale_fill_brewer(palette = "Set2") + labs(x = "", y = "Read Counts", title = "Trout Bog Metagenomes")
save_plot("C:/Users/Alex/Desktop/geodes/Plots/trout_metagenome_by_phyla.pdf", p, base_height = 5, base_aspect_ratio = 1.6)
mendota_metaG$Phylum <- metaG_key$Phylum[match(mendota_metaG$Genes, metaG_key$Gene)]
mendota_metaG$Phylum <- gsub("Cryptophyta,Cryptophyceae,Pyrenomonadales,Geminigeraceae,Guillardia,theta", "Cryptophyta", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("Haptophyta,Prymnesiophyceae,Isochrysidales,Noelaerhabdaceae,Emiliania,huxleyi", "Haptophyta", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("Heterokonta,Coscinodiscophyceae,Thalassiosirales,Thalassiosiraceae,Thalassiosira,pseudonana", "Heterokonta", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("Heterokonta,Pelagophyceae,Pelagomonadales,Pelagomonadaceae,Aureococcus,anophagefferens", "Heterokonta", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("Heterokonta,Ochrophyta,Eustigmataphyceae,Eustigmataceae,Nannochloropsis,gaditana", "Heterokonta", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("Heterokonta,Bacillariophyceae,Naviculales,Phaeodactylaceae,Phaeodactylum,tricornutum", "Heterokonta", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified unclassified", "Unclassified", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified", "Unclassified", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("unclassified unclassified unclassified", "Unclassified", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("NO CLASSIFICATION MH", "Unclassified", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("NO CLASSIFICATION LP", "Unclassified", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("None", "Unclassified", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("unclassified unclassified Perkinsida", "Perkinsozoa", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("unclassified unclassified", "Unclassified", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("unclassified Oligohymenophorea", "Ciliophora", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("unclassified Pelagophyceae", "Ochrophyta", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("unclassified", "Unclassified", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("Unclassified ", "Unclassified", mendota_metaG$Phylum)
mendota_metaG$Phylum <- gsub("UnclassifiedIsochrysidales", "Haptophyta", mendota_metaG$Phylum)
mendota_metaG$Phylum[which(is.na(mendota_metaG$Phylum) == T)] <- "Unclassified"
mendota_phyla <- aggregate(value ~ Phylum, data = mendota_metaG, mean)
mendota_phyla$Type <- c("Unclassified", "Bacteria", "Bacteria", "Bacteria", "Animals", "Fungi", "Algae", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Algae", "Fungi", "Protists", "Algae", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Algae", "Algae", "Bacteria", "Bacteria",  "Bacteria", "Bacteria", "Algae", "Protists", "Algae", "Bacteria", "Animals", "Bacteria", "Bacteria", "Algae", "Bacteria", "Unclassified", "Bacteria", "Viruses")
mendota_phyla$Phylum <- factor(mendota_phyla$Phylum, levels = mendota_phyla$Phylum[order(mendota_phyla$value, decreasing = T)])
p <- ggplot(mendota_phyla, aes(x = Phylum, y = value, fill = Type)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, vjust = 0, hjust = 1)) + scale_fill_brewer(palette = "Set2") + labs(x = "", y = "Read Counts", title = "Mendota Metagenomes")
save_plot("C:/Users/Alex/Desktop/geodes/Plots/mendota_metagenome_by_phyla.pdf", p, base_height = 5, base_aspect_ratio = 1.6)
spark2_metaG$Phylum <- metaG_key$Phylum[match(spark2_metaG$Genes, metaG_key$Gene)]
spark2_metaG$Phylum <- gsub("Cryptophyta,Cryptophyceae,Pyrenomonadales,Geminigeraceae,Guillardia,theta", "Cryptophyta", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("Haptophyta,Prymnesiophyceae,Isochrysidales,Noelaerhabdaceae,Emiliania,huxleyi", "Haptophyta", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("Heterokonta,Coscinodiscophyceae,Thalassiosirales,Thalassiosiraceae,Thalassiosira,pseudonana", "Heterokonta", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("Heterokonta,Pelagophyceae,Pelagomonadales,Pelagomonadaceae,Aureococcus,anophagefferens", "Heterokonta", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("Heterokonta,Ochrophyta,Eustigmataphyceae,Eustigmataceae,Nannochloropsis,gaditana", "Heterokonta", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("Heterokonta,Bacillariophyceae,Naviculales,Phaeodactylaceae,Phaeodactylum,tricornutum", "Heterokonta", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified unclassified", "Unclassified", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("unclassified unclassified unclassified unclassified", "Unclassified", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("unclassified unclassified unclassified", "Unclassified", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("NO CLASSIFICATION MH", "Unclassified", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("NO CLASSIFICATION LP", "Unclassified", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("None", "Unclassified", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("unclassified unclassified Perkinsida", "Perkinsozoa", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("unclassified unclassified", "Unclassified", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("unclassified Oligohymenophorea", "Ciliophora", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("unclassified Pelagophyceae", "Ochrophyta", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("unclassified", "Unclassified", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("Unclassified ", "Unclassified", spark2_metaG$Phylum)
spark2_metaG$Phylum <- gsub("UnclassifiedIsochrysidales", "Haptophyta", spark2_metaG$Phylum)
spark2_metaG$Phylum[which(is.na(spark2_metaG$Phylum) == T)] <- "Unclassified"
spark2_phyla <- aggregate(value ~ Phylum, data = spark2_metaG, mean)
spark2_phyla$Type <- c("Unclassified", "Bacteria", "Bacteria", "Bacteria", "Animals", "Fungi", "Algae", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Algae", "Fungi", "Protists", "Algae", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Bacteria", "Algae", "Algae", "Bacteria", "Bacteria",  "Bacteria", "Bacteria", "Algae", "Protists", "Algae", "Bacteria", "Animals", "Bacteria", "Bacteria", "Algae", "Bacteria", "Unclassified", "Bacteria", "Viruses")
spark2_phyla$Phylum <- factor(spark2_phyla$Phylum, levels = spark2_phyla$Phylum[order(spark2_phyla$value, decreasing = T)])
p <- ggplot(spark2_phyla, aes(x = Phylum, y = value, fill = Type)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, vjust = 0, hjust = 1)) + scale_fill_brewer(palette = "Set2") + labs(x = "", y = "Read Counts", title = "Sparkling Lake 2009 Metagenomes")
save_plot("C:/Users/Alex/Desktop/geodes/Plots/spark09_metagenome_by_phyla.pdf", p, base_height = 5, base_aspect_ratio = 1.6)
# Gene keys
mendota_key <- read.csv("D:/geodes_data_tables/Mendota_ID90_genekey.csv", header = T)
#spark_key <- read.csv("D:/geodes_data_tables/Sparkling_ID90_genekey.csv", header = T)
#trout_key <- read.csv("D:/geodes_data_tables/Trout_ID90_genekey.csv", header = T)
# Binning results
bins <- read.csv("D:/geodes_data_tables/GEODES_bin_data.csv", header = T)
contigs <- read.table("D:/geodes_data_tables/GEODES_binned_contigs.txt")
bin_metaG <- substr(bins$bin, start = 1, stop = 9)
head(bins)
bins <- bins[which(bins$completeness > 40 && bins$contamination < 5)]
#spark_key <- read.csv("D:/geodes_data_tables/Sparkling_ID90_genekey.csv", header = T)
#trout_key <- read.csv("D:/geodes_data_tables/Trout_ID90_genekey.csv", header = T)
# Binning results
bins <- read.csv("D:/geodes_data_tables/GEODES_bin_data.csv", header = T)
bins <- bins[which(bins$completeness > 40 && bins$contamination < 5), ]
#spark_key <- read.csv("D:/geodes_data_tables/Sparkling_ID90_genekey.csv", header = T)
#trout_key <- read.csv("D:/geodes_data_tables/Trout_ID90_genekey.csv", header = T)
# Binning results
bins <- read.csv("D:/geodes_data_tables/GEODES_bin_data.csv", header = T)
which(bins$completeness > 40)
length(which(bins$completeness > 40))
length(which(bins$contamination < 5))
length(which(bins$contamination < 5 & bins$completeness > 40))
bins <- bins[which(bins$completeness > 30 & bins$contamination < 10), ]
head(contigjs)
head(contigs)
contigs <- match(bins$bin, contigs$V2)
contigs <- read.table("D:/geodes_data_tables/GEODES_binned_contigs.txt")
contigs <- contigs[match(bins$bin, contigs$V2), ]
head(contigs)
contigs <- read.table("D:/geodes_data_tables/GEODES_binned_contigs.txt")
keep <- match(bins$bin, contigs$V2)
keep
keep <- match(contigs$V2, bins$bin)
head(keep)
contigs <- contigs[which(is.na(keep) == F), ]
head(contigs)
head(mendota_key)
tail(mendota_key)
reclassify <- match(mendota_key$Genome, contigs$V1)
head(reclassify)
head(contigs)
grep("Ga0164294_10001147", mendota_key$Genome)
mendota_key[grep("Ga0164294_10001147", mendota_key$Genome), ]
dim(mendota_key)
reclassify <- match(mendota_key$Genomes, contigs$V1)
head(mendota_key)
reclassify <- match(mendota_key$Genome, contigs$V1)
head(reclassify)
reclassify2 <- which(is.na(reclassify) == F)
contigs[23138,]
type <- substr(mendota_key$Genome, start = 1, stop = 2)
search <- which(type == "Ga")
head(search)
i=1
search[i]
mendota_key$Gene[search[i]]
head(contigs)
substr(mendota_key$Gene[search[i]], start=1, stop=18)
genome <- substr(mendota_key$Gene[search[i]], start=1, stop=18)
contigs$V2[which(contigs$V1 == genome)]
which(contigs$V1 == genome)
head(contigs)
genome <- substr(mendota_key$Gene[search[i]], start=1, stop=19)
which(contigs$V1 == genome)
bin_match <- contigs$V2[which(contigs$V1 == genome)]
bin_match
length(bin_match)
grep("Ga0164294_10001788", mendota_key)
for(i in 1:length(search)){
genome <- substr(mendota_key$Gene[search[i]], start=1, stop=19)
bin_match <- contigs$V2[which(contigs$V1 == genome)]
if(length(bin_match) > 0){
newtax <- bins$phylodist_taxonomy[which(bins$bin == bin_match)]
mendota_key$Taxonomy[search[i]] <- newtax
print("Yay, a match!")
}
}
for(i in 1:length(search)){
genome <- substr(mendota_key$Gene[search[i]], start=1, stop=19)
bin_match <- contigs$V2[which(contigs$V1 == genome)]
if(length(bin_match) > 0){
newtax <- bins$phylodist_taxonomy[which(bins$bin == bin_match)]
mendota_key$Taxonomy[search[i]] <- newtax
print(paste("Yay, a match!", search[i]))
}
}
genome <- substr(mendota_key$Gene, start=1, stop=19)
search <- match(genome, contigs$V1)
head(search)
where_in_key <- which(is.na(search) == F)
head(genome)
head(contigs$V1)
search <- match(genome, as.character(contigs$V1))
where_in_key <- which(is.na(search) == F)
head(search)
length("Ga0164294_10001147")
nchar("Ga0164294_10001147")
nchar("A023D18DRAFT_000000")
genome <- substr(mendota_key$Gene, start=1, stop=18)
search <- match(genome, as.character(contigs$V1))
where_in_key <- which(is.na(search) == F)
matching_bins <- contigs$V2[where_in_key]
head(matching_bins)
taxonomy_add <- bins$phylodist_taxonomy[match(matching_bins, bins$bin)]
length(taxonomy_add)
head(taxonomy_add)
taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
mendota_key[where_in_key] <- taxonomy_add
head(where_in_key)
mendota_key[c(23138,23139),]
mendota_key$Taxonomy[where_in_key] <- taxonomy_add
# Gene keys
mendota_key <- read.csv("D:/geodes_data_tables/Mendota_ID90_genekey.csv", header = T)
mendota_key$Taxonomy <- as.character(mendota_key$Taxonomy)
genome <- substr(mendota_key$Gene, start=1, stop=18)
search <- match(genome, as.character(contigs$V1))
where_in_key <- which(is.na(search) == F)
matching_bins <- contigs$V2[where_in_key]
taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
mendota_key$Taxonomy[where_in_key] <- taxonomy_add
mendota_key[c(23138,23139),]
grep("Ga0164292_10000084", contigs$V1)
contigs[74068]
contigs[74068,]
grep("GEODES117-binned.102", bins)
bins
mendota_key <- read.csv("D:/geodes_data_tables/Mendota_ID90_genekey.csv", header = T)
#spark_key <- read.csv("D:/geodes_data_tables/Sparkling_ID90_genekey.csv", header = T)
#trout_key <- read.csv("D:/geodes_data_tables/Trout_ID90_genekey.csv", header = T)
# Binning results
bins <- read.csv("D:/geodes_data_tables/GEODES_bin_data.csv", header = T)
contigs <- read.table("D:/geodes_data_tables/GEODES_binned_contigs.txt")
# Keep only good bins
bins <- bins[which(bins$completeness > 30 & bins$contamination < 10), ]
keep <- match(contigs$V2, bins$bin)
contigs <- contigs[which(is.na(keep) == F), ]
mendota_key$Taxonomy <- as.character(mendota_key$Taxonomy)
search <- match(mendota_key$Genome, as.character(contigs$V1))
where_in_key <- which(is.na(search) == F)
matching_bins <- contigs$V2[where_in_key]
taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
head(where_in_key)
test <- where_in_key[1:5]
mendota_key[test,]
matching_bins[1:5]
contigs[test]
contigs[test,]
where_in_contigs <- search[where_in_key]
where_in_key[1:5]
where_in_contigs[1:5]
contigs[where_in_contigs[1:5], ]
matching_bins <- contigs$V2[where_in_contigs]
matching_bins[1:5]
match(matching_bins, bins$bin)[1:5]
bins[83]
bins[83,]
taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
taxonomy_add[1:5]
mendota_key$Taxonomy[where_in_key] <- taxonomy_add
mendota_key[test,]
mendota_key$Taxonomy <- as.character(mendota_key$Taxonomy)
search <- match(mendota_key$Genome, as.character(contigs$V1))
where_in_key <- which(is.na(search) == F)
where_in_contigs <- search[where_in_key]
matching_bins <- contigs$V2[where_in_contigs]
taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
mendota_key$Taxonomy[where_in_key] <- taxonomy_add
write.csv(mendota_key, "D:/geodes_data_tables/Mendota_ID90_genekey_reclassified.csv", quote = F)
spark_key <- read.csv("D:/geodes_data_tables/Sparkling_ID90_genekey.csv", header = T)
#trout_key <- read.csv("D:/geodes_data_tables/Trout_ID90_genekey.csv", header = T)
# Binning results
bins <- read.csv("D:/geodes_data_tables/GEODES_bin_data.csv", header = T)
contigs <- read.table("D:/geodes_data_tables/GEODES_binned_contigs.txt")
# Keep only good bins
bins <- bins[which(bins$completeness > 30 & bins$contamination < 10), ]
keep <- match(contigs$V2, bins$bin)
contigs <- contigs[which(is.na(keep) == F), ]
# Replace in lake keys
# mendota_key$Taxonomy <- as.character(mendota_key$Taxonomy)
# search <- match(mendota_key$Genome, as.character(contigs$V1))
# where_in_key <- which(is.na(search) == F)
# where_in_contigs <- search[where_in_key]
# matching_bins <- contigs$V2[where_in_contigs]
# taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
# mendota_key$Taxonomy[where_in_key] <- taxonomy_add
#
# write.csv(mendota_key, "D:/geodes_data_tables/Mendota_ID90_genekey_reclassified.csv", quote = F)
spark_key$Taxonomy <- as.character(spark_key$Taxonomy)
search <- match(spark_key$Genome, as.character(contigs$V1))
where_in_key <- which(is.na(search) == F)
where_in_contigs <- search[where_in_key]
matching_bins <- contigs$V2[where_in_contigs]
taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
spark_key$Taxonomy[where_in_key] <- taxonomy_add
write.csv(spark_key, "D:/geodes_data_tables/Sparkling_ID90_genekey_reclassified.csv", quote = F)
# trout_key$Taxonomy <- as.character(trout_key$Taxonomy)
# search <- match(trout_key$Genome, as.character(contigs$V1))
# where_in_key <- which(is.na(search) == F)
# where_in_contigs <- search[where_in_key]
# matching_bins <- contigs$V2[where_in_contigs]
# taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
# trout_key$Taxonomy[where_in_key] <- taxonomy_add
#
# write.csv(trout_key, "D:/geodes_data_tables/Trout_ID90_genekey_reclassified.csv", quote = F)
trout_key <- read.csv("D:/geodes_data_tables/Trout_ID90_genekey.csv", header = T)
# Binning results
bins <- read.csv("D:/geodes_data_tables/GEODES_bin_data.csv", header = T)
contigs <- read.table("D:/geodes_data_tables/GEODES_binned_contigs.txt")
# Keep only good bins
bins <- bins[which(bins$completeness > 30 & bins$contamination < 10), ]
keep <- match(contigs$V2, bins$bin)
contigs <- contigs[which(is.na(keep) == F), ]
# Replace in lake keys
# mendota_key$Taxonomy <- as.character(mendota_key$Taxonomy)
# search <- match(mendota_key$Genome, as.character(contigs$V1))
# where_in_key <- which(is.na(search) == F)
# where_in_contigs <- search[where_in_key]
# matching_bins <- contigs$V2[where_in_contigs]
# taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
# mendota_key$Taxonomy[where_in_key] <- taxonomy_add
#
# write.csv(mendota_key, "D:/geodes_data_tables/Mendota_ID90_genekey_reclassified.csv", quote = F)
# spark_key$Taxonomy <- as.character(spark_key$Taxonomy)
# search <- match(spark_key$Genome, as.character(contigs$V1))
# where_in_key <- which(is.na(search) == F)
# where_in_contigs <- search[where_in_key]
# matching_bins <- contigs$V2[where_in_contigs]
# taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
# spark_key$Taxonomy[where_in_key] <- taxonomy_add
#
# write.csv(spark_key, "D:/geodes_data_tables/Sparkling_ID90_genekey_reclassified.csv", quote = F)
trout_key$Taxonomy <- as.character(trout_key$Taxonomy)
search <- match(trout_key$Genome, as.character(contigs$V1))
where_in_key <- which(is.na(search) == F)
where_in_contigs <- search[where_in_key]
matching_bins <- contigs$V2[where_in_contigs]
taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
trout_key$Taxonomy[where_in_key] <- taxonomy_add
write.csv(trout_key, "D:/geodes_data_tables/Trout_ID90_genekey_reclassified.csv", quote = F)
debugSource('C:/Users/Alex/Desktop/geodes/bioinformatics_workflow/R_processing/summary_stats.R', echo=TRUE)
# Gene keys
mendota_key <- read.csv("D:/geodes_data_tables/Mendota_ID90_genekey_reclassified.csv", header = T)
spark_key <- read.csv("D:/geodes_data_tables/Sparkling_ID90_genekey_reclassified.csv", header = T)
# Gene keys
mendota_key <- read.csv("D:/geodes_data_tables/Mendota_ID90_genekey.csv", header = T)
bins <- read.csv("D:/geodes_data_tables/GEODES_bin_data.csv", header = T)
contigs <- read.table("D:/geodes_data_tables/GEODES_binned_contigs.txt")
# Keep only good bins
bins <- bins[which(bins$completeness > 30 & bins$contamination < 10), ]
keep <- match(contigs$V2, bins$bin)
contigs <- contigs[which(is.na(keep) == F), ]
mendota_key$Taxonomy <- as.character(mendota_key$Taxonomy)
search <- match(mendota_key$Genome, as.character(contigs$V1))
where_in_key <- which(is.na(search) == F)
where_in_contigs <- search[where_in_key]
matching_bins <- contigs$V2[where_in_contigs]
taxonomy_add <- as.character(bins$phylodist_taxonomy[match(matching_bins, bins$bin)])
mendota_key$Taxonomy[where_in_key] <- taxonomy_add
head(mendota_key)
write.csv(mendota_key, "D:/geodes_data_tables/Mendota_ID90_genekey_reclassified.csv", row.names = F, col.names = F)
