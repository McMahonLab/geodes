table <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Pathway_analysis/consolidated_pathway_data.csv", header = T)
head(table)
metadata <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Supplemental/MAG_information.csv")
head(metadata)
phylum <- sapply(strsplit(as.character(metadata$Taxonomy.README.),";"), `[`, 1)
class<- sapply(strsplit(as.character(metadata$Taxonomy.README.),";"), `[`, 2)
order <- sapply(strsplit(as.character(metadata$Taxonomy.README.),";"), `[`, 3)
phylum <- sapply(strsplit(as.character(metadata$Taxonomy),";"), `[`, 1)
class<- sapply(strsplit(as.character(metadata$Taxonomy),";"), `[`, 2)
order <- sapply(strsplit(as.character(metadata$Taxonomy),";"), `[`, 3)
length(unique(order))
colnames(table)
gsub("x", "", colnames(table))
gsub("x", "", colnames(table))
gsub("X", "", colnames(table))
colnames(table) <- gsub("X", "", colnames(table))
match(colnames(table), metadata$IMG_OID[which(metadata$Lake == "Mendota")])
length(match(colnames(table), metadata$IMG_OID[which(metadata$Lake == "Mendota")]))
which(is.na(match(colnames(table), metadata$IMG_OID[which(metadata$Lake == "Mendota")])) == F)
colnames(table)[1:5]
table[1:5, 1:5]
table[which(is.na(table) == T)] <- 0
table <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Pathway_analysis/consolidated_pathway_data.csv", header = T, na.strings = 0)
table[1:5, 1:5]
table <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Pathway_analysis/consolidated_pathway_data.csv", header = T, na.strings = "0")
table[1:5, 1:5]
table <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Pathway_analysis/consolidated_pathway_data.csv", header = T)
colnames(table) <- gsub("X", "", colnames(table))
dim(table)
for(i in 1:dim(table)[2]){
column <- table[,i]
column[which(is.na(column) == T)] <- 0
table[,i] <- column
}
table[1:5, 1:5]
table[3,which(table[3,] < 100)] <- 0
table[1:5, 1:5]
table[3,which(table[3,] < 100 & is.numeric(table[3,]) == T)] <- 0
is.numeric(table[3,]) == T
rTCA <- table[3,2:196]
rTCA[which(rTCA < 100)] <- 0
rTCA
rTCA <- table[3,3:196]
rTCA[which(rTCA < 100)] <- 0
rTCA <- table[2,3:196]
rTCA[which(rTCA < 100)] <- 0
rTCA
table[2,3:196] <- rTCA
table[1:5, 1:5]
table$Pathway < -gsub("(*)", "", table$Pathway)
table$Pathway < -gsub("/(*/)", "", table$Pathway)
table$Pathway < -gsub("//(*//)", "", table$Pathway)
table$Pathway <- gsub("(*)", "", table$Pathway)
table[1:5, 1:5]
ME.MAGs <- table[,which(is.na(match(colnames(table), metadata$IMG_OID[which(metadata$Lake == "Mendota")])) == F)]
head(ME.MAGs)
heatmap(ME.MAGs)
heatmap(as.matrix(ME.MAGs))
rownames(ME.MAGs) <- table$Pathway
rownames(ME.MAGs) <- make.unique(table$Pathway)
heatmap(as.matrix(ME.MAGs), Rowv = NA)
library(reshape2)
tail(table)
table <- table[1:61,]
ME.long <- melt(ME.MAGs)
head(ME.long)
ME.MAGs <- table[,which(is.na(match(colnames(table), metadata$IMG_OID[which(metadata$Lake == "Mendota")])) == F)]
ME.MAGs$Pathways <- make.unique(table$Pathway)
ME.long <- melt(ME.MAGs)
head(ME.long)
ME.long$Pathways <- factor(ME.long$Pathways, levels = table$Pathway)
ME.long$variable <- factor(ME.long$variable, levels = colnames(table))
ggplot(data = ME.long, aes(x = Pathways, y = variable, fill = value)) + geom_tile()
library(ggplot2)
library(cowplot)
ggplot(data = ME.long, aes(x = Pathways, y = variable, fill = value)) + geom_tile()
ggplot(data = ME.long, aes(x = Pathways, y = variable, fill = value)) + geom_tile() + labs(x = "", y = "") + scale_fill_gradient2(low = "#d8b365", mid = "white", high = "#5ab4ac", midpoint = 50) + theme(axis.text.x = element_text(angle = 270))
ggplot(data = ME.long, aes(x = Pathways, y = variable, fill = value)) + geom_tile() + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#5ab4ac", midpoint = 50) + theme(axis.text.x = element_text(angle = -90))
ggplot(data = ME.long, aes(x = Pathways, y = variable, fill = value)) + geom_tile() + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#5ab4ac", midpoint = 50) + theme(axis.text.x = element_text(angle = 90))
table <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Pathway_analysis/consolidated_pathway_data.csv", header = T)
metadata <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Supplemental/MAG_information.csv")
library(ggplot2)
library(cowplot)
library(reshape2)
#make a long format table - for each phylum and lake, count how many times each pathway appears.
phylum <- sapply(strsplit(as.character(metadata$Taxonomy),";"), `[`, 1)
class<- sapply(strsplit(as.character(metadata$Taxonomy),";"), `[`, 2)
order <- sapply(strsplit(as.character(metadata$Taxonomy),";"), `[`, 3)
colnames(table) <- gsub("X", "", colnames(table))
table <- table[1:61,]
for(i in 3:dim(table)[2]){
column <- table[,i]
column[which(is.na(column) == T)] <- 0
table[,i] <- column
}
rTCA <- table[2,3:196]
rTCA[which(rTCA < 100)] <- 0
table[2,3:196] <- rTCA
table$Pathway <- gsub("(*)", "", table$Pathway)
ME.MAGs <- table[,which(is.na(match(colnames(table), metadata$IMG_OID[which(metadata$Lake == "Mendota")])) == F)]
ME.MAGs$Pathways <- make.unique(table$Pathway)
ME.long <- melt(ME.MAGs)
ME.long$Pathways <- factor(ME.long$Pathways, levels = table$Pathway)
ME.long$variable <- factor(ME.long$variable, levels = colnames(table))
ggplot(data = ME.long, aes(x = Pathways, y = variable, fill = value)) + geom_tile() + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 50) + theme(axis.text.x = element_text(angle = 90))
ggplot(data = ME.long, aes(y = Pathways, x = variable, fill = value)) + geom_tile() + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 50) + theme(axis.text.x = element_text(angle = 90))
ggplot(data = ME.long, aes(y = Pathways, x = variable, fill = value, color = black)) + geom_tile() + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 50) + theme(axis.text.x = element_text(angle = 90))
ggplot(data = ME.long, aes(y = Pathways, x = variable, fill = value, color = "black")) + geom_tile() + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 50) + theme(axis.text.x = element_text(angle = 90))
ggplot(data = ME.long, aes(y = Pathways, x = variable, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 50) + theme(axis.text.x = element_text(angle = 90))
match(ME.long$variable, metadata$IMG_OID)
ME.long$Taxonomy <- metadata$Taxonomy[match(ME.long$variable, metadata$IMG_OID),]
ME.long$Taxonomy <- order[match(ME.long$variable, metadata$IMG_OID)]
ggplot(data = ME.long, aes(y = Pathways, x = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 50) + theme(axis.text.x = element_text(angle = 90))
table <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Pathway_analysis/consolidated_pathway_data.csv", header = T)
metadata <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Supplemental/MAG_information.csv")
library(ggplot2)
library(cowplot)
library(reshape2)
#make a long format table - for each phylum and lake, count how many times each pathway appears.
phylum <- sapply(strsplit(as.character(metadata$Taxonomy),";"), `[`, 1)
class<- sapply(strsplit(as.character(metadata$Taxonomy),";"), `[`, 2)
order <- sapply(strsplit(as.character(metadata$Taxonomy),";"), `[`, 3)
colnames(table) <- gsub("X", "", colnames(table))
table <- table[1:61,]
for(i in 3:dim(table)[2]){
column <- table[,i]
column[which(is.na(column) == T)] <- 0
table[,i] <- column
}
rTCA <- table[2,3:196]
rTCA[which(rTCA < 100)] <- 0
table[2,3:196] <- rTCA
table$Pathway <- gsub("(*)", "", table$Pathway)
ME.MAGs <- table[,which(is.na(match(colnames(table), metadata$IMG_OID[which(metadata$Lake == "Mendota")])) == F)]
ME.MAGs$Pathways <- make.unique(table$Pathway)
ME.long <- melt(ME.MAGs)
ME.long$Pathways <- factor(ME.long$Pathways, levels = table$Pathway)
ME.long$variable <- factor(ME.long$variable, levels = colnames(table))
ME.long$Taxonomy <- order[match(ME.long$variable, metadata$IMG_OID)]
ggplot(data = ME.long, aes(y = Pathways, x = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 50) + theme(axis.text.x = element_text(angle = 90))
ME.long$Taxonomy <- phylum[match(ME.long$variable, metadata$IMG_OID)]
ggplot(data = ME.long, aes(y = Pathways, x = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 50) + theme(axis.text.x = element_text(angle = 90))
ggplot(data = ME.long, aes(x = Pathways, y = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 50) + theme(axis.text.x = element_text(angle = 90))
ggplot(data = ME.long, aes(x = Pathways, y = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 75) + theme(axis.text.x = element_text(angle = 90))
ggplot(data = ME.long, aes(x = Pathways, y = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 25) + theme(axis.text.x = element_text(angle = 90))
ME.long$Taxonomy <- factor(ME.long$Taxonomy, levels = rev(levels(ME.long$Taxonomy)))
ggplot(data = ME.long, aes(x = Pathways, y = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 25) + theme(axis.text.x = element_text(angle = 90))
ME.long$Taxonomy <- phylum[match(ME.long$variable, metadata$IMG_OID)]
levels(ME.long$Taxonomy)
ME.long$Taxonomy <- phylum[match(ME.long$variable, metadata$IMG_OID)]
ggplot(data = ME.long, aes(x = Pathways, y = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 25) + theme(axis.text.x = element_text(angle = 90))
ggplot(data = ME.long, aes(x = Pathways, y = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 25) + theme(axis.text.x = element_text(angle = 90)) + scale_y_reverse()
ggplot(data = ME.long, aes(x = Pathways, y = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 25) + theme(axis.text.x = element_text(angle = 90, vjust = 1))
ggplot(data = ME.long, aes(x = Pathways, y = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 25) + theme(axis.text.x = element_text(angle = 90, vjust = 0))
ggplot(data = ME.long, aes(x = Pathways, y = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 25) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(data = ME.long, aes(y = Pathways, x = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 25) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(data = ME.long, aes(y = Pathways, x = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#5ab4ac", midpoint = 25) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
TE.MAGs <- table[,which(is.na(match(colnames(table), metadata$IMG_OID[which(metadata$Lake == "Trout Bog Epilimnion")])) == F)]
TE.MAGs$Pathways <- make.unique(table$Pathway)
TE.long <- melt(TE.MAGs)
TE.long$Pathways <- factor(TE.long$Pathways, levels = table$Pathway)
TE.long$variable <- factor(TE.long$variable, levels = colnames(table))
TE.long$Taxonomy <- phylum[match(TE.long$variable, metadata$IMG_OID)]
ggplot(data = TE.long, aes(y = Pathways, x = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#67a9cf", midpoint = 25) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
TH.MAGs <- table[,which(is.na(match(colnames(table), metadata$IMG_OID[which(metadata$Lake == "Trout Bog Hypolimnion")])) == F)]
TH.MAGs$Pathways <- make.unique(table$Pathway)
TH.long <- melt(TH.MAGs)
TH.long$Pathways <- factor(TH.long$Pathways, levels = table$Pathway)
TH.long$variable <- factor(TH.long$variable, levels = colnames(table))
TH.long$Taxonomy <- phylum[match(TH.long$variable, metadata$IMG_OID)]
ggplot(data = TH.long, aes(y = Pathways, x = Taxonomy, fill = value)) + geom_tile(color = "black") + labs(x = "", y = "") + scale_fill_gradient2(low = "white", high = "#d8b365", midpoint = 25) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
